modules:
  # 1) Enable RPM Fusion (EL10)
  - type: dnf
    repos:
      keys:
        - https://download1.rpmfusion.org/free/el/RPM-GPG-KEY-rpmfusion-free-el-10
        - https://download1.rpmfusion.org/nonfree/el/RPM-GPG-KEY-rpmfusion-nonfree-el-10
    install:
      packages:
        - https://mirrors.rpmfusion.org/free/el/rpmfusion-free-release-10.noarch.rpm
        - https://mirrors.rpmfusion.org/nonfree/el/rpmfusion-nonfree-release-10.noarch.rpm

# 2) Prebuilt kABI-tracking kmod for Broadcom wl (no compilers, OOTB)
- type: dnf
  install:
    install-weak-deps: false
    packages:
      - kmod-wl
      - broadcom-wl          # ships the blacklist for b43/bcma/brcmsmac
      - rfkill
      - iw
      - wpa_supplicant

# 3) Remove RPM Fusion repo definitions (keep installed packages)
- type: dnf
  remove:
    auto-remove: false
    packages:
      - rpmfusion-free-release
      - rpmfusion-nonfree-release