// Disks / removable media / LUKS / basic formatting (UDisks2)
polkit.addRule(function (action, subject) {
  const ok = subject.isInGroup("wheel") && subject.active && subject.local;
  const acts = new Set([
    // Mounting & unmounting
    "org.freedesktop.udisks2.filesystem-mount",
    "org.freedesktop.udisks2.filesystem-mount-system",
    "org.freedesktop.udisks2.filesystem-unmount-others",

    // Encrypted devices
    "org.freedesktop.udisks2.encrypted-unlock",

    // Media & drive power
    "org.freedesktop.udisks2.eject-media",
    "org.freedesktop.udisks2.power-off-drive",

    // Device management (format/label/partition via gnome-disk-utility)
    "org.freedesktop.udisks2.modify-device",
    "org.freedesktop.udisks2.rescan",
    "org.freedesktop.udisks2.open-device",

    // Loop devices (create/delete)
    "org.freedesktop.udisks2.loop-setup",
    "org.freedesktop.udisks2.loop-delete-others",
  ]);
  if (acts.has(action.id)) return ok ? polkit.Result.AUTH_ADMIN_KEEP : polkit.Result.NO;
});
